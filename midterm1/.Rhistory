for (j in length(p6_poly_df)){
if (p6_poly_df[j] < test){
test <- p6_poly_df[j]
}
}
p6_poly_in <- c(p6_poly_in, test)
}
p6_poly_in
which.min(p6_poly_in)
strain_df_p6[index[which.min(p6_poly_in)]]
index[which.min(p6_poly_in)]
p6_poly_var <- strain_df_p6[1,index[which.min(p6_poly_in)]]
p6_poly_var
p6_poly_var <- colname(strain_df_p6[,index[which.min(p6_poly_in)]])
p6_poly_var <- colnames(strain_df_p6[,index[which.min(p6_poly_in)]])
p6_poly_var
p6_poly_var <- colnames(as.data.frame(strain_df_p6[,index[which.min(p6_poly_in)]]))
p6_poly_var
p6_poly_var <- as.data.frame(colnames(strain_df_p6[,index[which.min(p6_poly_in)]]))
p6_poly_var
p6_poly_var <- data.frame(var = colnames(strain_df_p6[,index[which.min(p6_poly_in)]]))
p6_poly_var
index[which.min(p6_poly_in)]
colnames(strain_df_p6[,49])
names(strain_df_p6[,49])
strain_df_p6[,49]
for (i in index){
p6_poly_1 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],1))
p6_poly_2 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],2))
p6_poly_3 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],3))
p6_poly_4 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],4))
p6_poly_5 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],5))
p6_poly_6 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],6))
p6_poly_7 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],7))
p6_poly_8 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],8))
p6_poly_df <- t(cbind(lm_pred_metrics(p6_poly_1), lm_pred_metrics(p6_poly_2),
lm_pred_metrics(p6_poly_3), lm_pred_metrics(p6_poly_4),
lm_pred_metrics(p6_poly_5), lm_pred_metrics(p6_poly_6),
lm_pred_metrics(p6_poly_7), lm_pred_metrics(p6_poly_8)))
test <- p6_poly_df[1]
for (j in length(p6_poly_df)){
if (p6_poly_df[j] < test){
test <- p6_poly_df[j]
deg <- j
}
}
p6_poly_in <- c(p6_poly_in, test)
p6_polydeg <- data.frame(p6_poly_in, deg)
}
View(p6_polydeg)
for (i in index){
p6_poly_1 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],1))
p6_poly_2 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],2))
p6_poly_3 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],3))
p6_poly_4 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],4))
p6_poly_5 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],5))
p6_poly_6 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],6))
p6_poly_7 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],7))
p6_poly_8 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],8))
p6_poly_df <- t(cbind(lm_pred_metrics(p6_poly_1), lm_pred_metrics(p6_poly_2),
lm_pred_metrics(p6_poly_3), lm_pred_metrics(p6_poly_4),
lm_pred_metrics(p6_poly_5), lm_pred_metrics(p6_poly_6),
lm_pred_metrics(p6_poly_7), lm_pred_metrics(p6_poly_8)))
test <- p6_poly_df[1]
deg <- 0
for (j in length(p6_poly_df)){
if (p6_poly_df[j] < test){
test <- p6_poly_df[j]
deg <- j
}
}
p6_poly_in <- c(p6_poly_in, test)
p6_polydeg <- data.frame(p6_poly_in, deg)
}
p6_poly_1 <- lm(strain_df_p6$shares~poly(strain_df_p6[,3],1))
p6_poly_8 <- lm(strain_df_p6$shares~poly(strain_df_p6[,3],8))
lm_pred_metrics(p6_poly_8)
lm_pred_metrics(p6_poly_1)
for (i in 1:3){
p6_poly_1 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],1))
p6_poly_2 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],2))
p6_poly_3 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],3))
p6_poly_4 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],4))
p6_poly_5 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],5))
p6_poly_6 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],6))
p6_poly_7 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],7))
p6_poly_8 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],8))
p6_poly_df <- t(cbind(lm_pred_metrics(p6_poly_1), lm_pred_metrics(p6_poly_2),
lm_pred_metrics(p6_poly_3), lm_pred_metrics(p6_poly_4),
lm_pred_metrics(p6_poly_5), lm_pred_metrics(p6_poly_6),
lm_pred_metrics(p6_poly_7), lm_pred_metrics(p6_poly_8)))
test <- p6_poly_df[1]
deg <- 0
for (j in length(p6_poly_df)){
if (p6_poly_df[j] <= test){
test <- p6_poly_df[j]
deg <- j
}
}
p6_poly_in <- c(p6_poly_in, test)
p6_polydeg <- data.frame(p6_poly_in, deg)
}
for (i in 1:3){
p6_poly_1 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],1))
p6_poly_2 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],2))
p6_poly_3 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],3))
p6_poly_4 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],4))
p6_poly_5 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],5))
p6_poly_6 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],6))
p6_poly_7 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],7))
p6_poly_8 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],8))
p6_poly_df <- t(cbind(lm_pred_metrics(p6_poly_1), lm_pred_metrics(p6_poly_2),
lm_pred_metrics(p6_poly_3), lm_pred_metrics(p6_poly_4),
lm_pred_metrics(p6_poly_5), lm_pred_metrics(p6_poly_6),
lm_pred_metrics(p6_poly_7), lm_pred_metrics(p6_poly_8)))
test <- p6_poly_df[1]
for (j in length(p6_poly_df)){
if (p6_poly_df[j] <= test){
test <- p6_poly_df[j]
deg <- j
}
}
p6_poly_in <- c(p6_poly_in, test)
p6_polydeg <- data.frame(p6_poly_in, deg)
}
for (i in 1:3){
p6_poly_1 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],1))
p6_poly_2 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],2))
p6_poly_3 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],3))
p6_poly_4 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],4))
p6_poly_5 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],5))
p6_poly_6 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],6))
p6_poly_7 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],7))
p6_poly_8 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],8))
p6_poly_df <- t(cbind(lm_pred_metrics(p6_poly_1), lm_pred_metrics(p6_poly_2),
lm_pred_metrics(p6_poly_3), lm_pred_metrics(p6_poly_4),
lm_pred_metrics(p6_poly_5), lm_pred_metrics(p6_poly_6),
lm_pred_metrics(p6_poly_7), lm_pred_metrics(p6_poly_8)))
test <- p6_poly_df[1]
for (j in length(p6_poly_df)){
if (p6_poly_df[j] <= test){
test <- p6_poly_df[j]
deg <- j
break
}
}
p6_poly_in <- c(p6_poly_in, test)
p6_polydeg <- data.frame(p6_poly_in, deg)
}
min(p6_poly_in)
p6_poly_df.min
p6_poly_df <- cbind(lm_pred_metrics(p6_poly_1), lm_pred_metrics(p6_poly_2),
lm_pred_metrics(p6_poly_3), lm_pred_metrics(p6_poly_4),
lm_pred_metrics(p6_poly_5), lm_pred_metrics(p6_poly_6),
lm_pred_metrics(p6_poly_7), lm_pred_metrics(p6_poly_8))
p6_poly_df.min
min(p6_poly_df)
which.min(p6_poly_df)
for (i in 1:3){
p6_poly_1 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],1))
p6_poly_2 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],2))
p6_poly_3 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],3))
p6_poly_4 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],4))
p6_poly_5 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],5))
p6_poly_6 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],6))
p6_poly_7 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],7))
p6_poly_8 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],8))
p6_poly_df <- cbind(lm_pred_metrics(p6_poly_1), lm_pred_metrics(p6_poly_2),
lm_pred_metrics(p6_poly_3), lm_pred_metrics(p6_poly_4),
lm_pred_metrics(p6_poly_5), lm_pred_metrics(p6_poly_6),
lm_pred_metrics(p6_poly_7), lm_pred_metrics(p6_poly_8))
test <- p6_poly_df[1]
for (j in length(p6_poly_df)){
if (p6_poly_df[j] <= test){
test <- p6_poly_df[j]
}
}
p6_poly_in <- c(p6_poly_in, test, deg = min(p6_poly_df))
}
p6_poly_in
for (i in 1:3){
p6_poly_1 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],1))
p6_poly_2 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],2))
p6_poly_3 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],3))
p6_poly_4 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],4))
p6_poly_5 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],5))
p6_poly_6 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],6))
p6_poly_7 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],7))
p6_poly_8 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],8))
p6_poly_df <- cbind(lm_pred_metrics(p6_poly_1), lm_pred_metrics(p6_poly_2),
lm_pred_metrics(p6_poly_3), lm_pred_metrics(p6_poly_4),
lm_pred_metrics(p6_poly_5), lm_pred_metrics(p6_poly_6),
lm_pred_metrics(p6_poly_7), lm_pred_metrics(p6_poly_8))
test <- p6_poly_df[1]
for (j in length(p6_poly_df)){
if (p6_poly_df[j] <= test){
test <- p6_poly_df[j]
}
}
p6_poly_in <- c(p6_poly_in, test, deg = which.min(p6_poly_df))
}
for (i in 1:3){
p6_poly_1 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],1))
p6_poly_2 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],2))
p6_poly_3 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],3))
p6_poly_4 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],4))
p6_poly_5 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],5))
p6_poly_6 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],6))
p6_poly_7 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],7))
p6_poly_8 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],8))
p6_poly_df <- cbind(lm_pred_metrics(p6_poly_1), lm_pred_metrics(p6_poly_2),
lm_pred_metrics(p6_poly_3), lm_pred_metrics(p6_poly_4),
lm_pred_metrics(p6_poly_5), lm_pred_metrics(p6_poly_6),
lm_pred_metrics(p6_poly_7), lm_pred_metrics(p6_poly_8))
test <- p6_poly_df[1]
for (j in length(p6_poly_df)){
if (p6_poly_df[j] <= test){
test <- p6_poly_df[j]
}
}
p6_poly_in <- c(p6_poly_in, test, deg = which.min(p6_poly_df))
p6_poly_deg <- c(p6_poly_deg, which.min(p6_poly_df))
}
p6_poly_in <- c()
p6_poly_deg <- c()
for (i in 1:3){
p6_poly_1 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],1))
p6_poly_2 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],2))
p6_poly_3 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],3))
p6_poly_4 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],4))
p6_poly_5 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],5))
p6_poly_6 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],6))
p6_poly_7 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],7))
p6_poly_8 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],8))
p6_poly_df <- cbind(lm_pred_metrics(p6_poly_1), lm_pred_metrics(p6_poly_2),
lm_pred_metrics(p6_poly_3), lm_pred_metrics(p6_poly_4),
lm_pred_metrics(p6_poly_5), lm_pred_metrics(p6_poly_6),
lm_pred_metrics(p6_poly_7), lm_pred_metrics(p6_poly_8))
test <- p6_poly_df[1]
for (j in length(p6_poly_df)){
if (p6_poly_df[j] <= test){
test <- p6_poly_df[j]
}
}
p6_poly_in <- c(p6_poly_in, test, deg = which.min(p6_poly_df))
p6_poly_deg <- c(p6_poly_deg, which.min(p6_poly_df))
}
p6_poly_in_df <- data.frame(p6_poly_in, p6_poly_deg)
View(p6_poly_in_df)
for (i in 1:3){
p6_poly_1 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],1))
p6_poly_2 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],2))
p6_poly_3 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],3))
p6_poly_4 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],4))
p6_poly_5 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],5))
p6_poly_6 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],6))
p6_poly_7 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],7))
p6_poly_8 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],8))
p6_poly_df <- cbind(lm_pred_metrics(p6_poly_1), lm_pred_metrics(p6_poly_2),
lm_pred_metrics(p6_poly_3), lm_pred_metrics(p6_poly_4),
lm_pred_metrics(p6_poly_5), lm_pred_metrics(p6_poly_6),
lm_pred_metrics(p6_poly_7), lm_pred_metrics(p6_poly_8))
test <- p6_poly_df[1]
for (j in length(p6_poly_df)){
if (p6_poly_df[j] <= test){
test <- p6_poly_df[j]
}
}
p6_poly_in <- c(p6_poly_in, test)
p6_poly_deg <- c(p6_poly_deg, which.min(p6_poly_df))
}
p6_poly_in_df <- data.frame(p6_poly_in, p6_poly_deg)
for (i in 1:3){
p6_poly_1 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],1))
p6_poly_2 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],2))
p6_poly_3 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],3))
p6_poly_4 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],4))
p6_poly_5 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],5))
p6_poly_6 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],6))
p6_poly_7 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],7))
p6_poly_8 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],8))
p6_poly_df <- cbind(lm_pred_metrics(p6_poly_1), lm_pred_metrics(p6_poly_2),
lm_pred_metrics(p6_poly_3), lm_pred_metrics(p6_poly_4),
lm_pred_metrics(p6_poly_5), lm_pred_metrics(p6_poly_6),
lm_pred_metrics(p6_poly_7), lm_pred_metrics(p6_poly_8))
test <- p6_poly_df[1]
for (j in 2:length(p6_poly_df)){
if (p6_poly_df[j] < test){
test <- p6_poly_df[j]
}
}
p6_poly_in <- c(p6_poly_in, test)
p6_poly_deg <- c(p6_poly_deg, which.min(p6_poly_df))
}
for (i in 1){
p6_poly_1 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],1))
p6_poly_2 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],2))
p6_poly_3 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],3))
p6_poly_4 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],4))
p6_poly_5 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],5))
p6_poly_6 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],6))
p6_poly_7 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],7))
p6_poly_8 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],8))
p6_poly_df <- cbind(lm_pred_metrics(p6_poly_1), lm_pred_metrics(p6_poly_2),
lm_pred_metrics(p6_poly_3), lm_pred_metrics(p6_poly_4),
lm_pred_metrics(p6_poly_5), lm_pred_metrics(p6_poly_6),
lm_pred_metrics(p6_poly_7), lm_pred_metrics(p6_poly_8))
test <- p6_poly_df[1]
for (j in 2:length(p6_poly_df)){
if (p6_poly_df[j] < test){
test <- p6_poly_df[j]
}
}
p6_poly_in <- c(p6_poly_in, test)
p6_poly_deg <- c(p6_poly_deg, which.min(p6_poly_df))
}
p6_poly_mse <- c()
p6_poly_deg <- c()
for (i in 1){
p6_poly_1 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],1))
p6_poly_2 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],2))
p6_poly_3 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],3))
p6_poly_4 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],4))
p6_poly_5 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],5))
p6_poly_6 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],6))
p6_poly_7 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],7))
p6_poly_8 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],8))
p6_poly_df <- cbind(lm_pred_metrics(p6_poly_1), lm_pred_metrics(p6_poly_2),
lm_pred_metrics(p6_poly_3), lm_pred_metrics(p6_poly_4),
lm_pred_metrics(p6_poly_5), lm_pred_metrics(p6_poly_6),
lm_pred_metrics(p6_poly_7), lm_pred_metrics(p6_poly_8))
p6_poly_mse <- c(p6_poly_mse, min(p6_poly_df))
p6_poly_deg <- c(p6_poly_deg, which.min(p6_poly_df))
}
p6_poly <- data.frame(mse = p6_poly_mse, degree = p6_poly_deg)
View(p6_poly)
p6_poly_df <- cbind(lm_pred_metrics(p6_poly_1), lm_pred_metrics(p6_poly_2),
lm_pred_metrics(p6_poly_3), lm_pred_metrics(p6_poly_4),
lm_pred_metrics(p6_poly_5), lm_pred_metrics(p6_poly_6),
lm_pred_metrics(p6_poly_7), lm_pred_metrics(p6_poly_8))
View(p6_poly_df)
index <- c(1:3, 7:12, 19:30, 39:59)
p6_poly_mse <- c()
p6_poly_deg <- c()
for (i in index){
p6_poly_1 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],1))
p6_poly_2 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],2))
p6_poly_3 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],3))
p6_poly_4 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],4))
p6_poly_5 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],5))
p6_poly_6 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],6))
p6_poly_7 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],7))
p6_poly_8 <- lm(strain_df_p6$shares~poly(strain_df_p6[,i],8))
p6_poly_df <- cbind(lm_pred_metrics(p6_poly_1), lm_pred_metrics(p6_poly_2),
lm_pred_metrics(p6_poly_3), lm_pred_metrics(p6_poly_4),
lm_pred_metrics(p6_poly_5), lm_pred_metrics(p6_poly_6),
lm_pred_metrics(p6_poly_7), lm_pred_metrics(p6_poly_8))
p6_poly_mse <- c(p6_poly_mse, min(p6_poly_df))
p6_poly_deg <- c(p6_poly_deg, which.min(p6_poly_df))
}
p6_poly <- data.frame(mse = p6_poly_mse, degree = p6_poly_deg)
View(p6_poly)
p6_poly_in
index[which.min(p6_poly)] #select 49th variable in strain_df_p6
index[which.min(p6_poly$mse)] #select 49th variable in strain_df_p6
which.min(p6_poly$mse)
colnames(strain_df_p6[,27])
names(strain_df_p6[,27])
variable.names(strain_df_p6[,27])
variable.names(strain_df_p6[1,27])
strain_df_p6[,27]
#in sample EPE is:
p6_poly_optimal <- lm(strain_df_p6$shares~poly(strain_df_p6$kw_avg_avg,7))
lm_pred_metrics(p6_poly_optimal)
View(p6_poly_optimal)
#in sample EPE is:
p6_poly_optimal <- lm(data = strain_df_p6, shares~poly(kw_avg_avg,7))
lm_pred_metrics(p6_poly_optimal)
#out of sample EPE is:
p6_poly_pred <- p6_poly_optimal %>% predict(stest_df_p6)
p6_poly_pred
#out of sample EPE is:
p6_poly_pred <- p6_poly_optimal %>% predict(stest_df_p6$shares)
p6_poly_out <- mse(p6_poly_pred, stest_df_p6$shares)
p6_poly_out
p6_knn_weekday_is_wednesday_mse <- data.frame(model = "KNN", var = p6_knn_out_df[33,1], mse_out = p6_knn_out_df[33,2], mse_in = p6_knn_in_df[33,2])
p6_knn_weekday_is_wednesday_mse
p6_result <- data.frame(model = "KNN", var = p6_knn_out_df[33,1], mse_out = p6_knn_out_df[33,2], mse_in = p6_knn_in_df[33,2])
#compile into final result
p6_result
#compile into final result
p6_poly_result <- data.frame(model = "Polynomial_deg_7", var = "kw_avg_avg", mse_out = p6_poly_out, mse_in = p6_poly_in)
p6_poly_result
#in sample EPE is:
p6_poly_optimal <- lm(data = strain_df_p6, shares~poly(kw_avg_avg,7))
p6_poly_in <- lm_pred_metrics(p6_poly_optimal)
p6_poly_in
#out of sample EPE is:
p6_poly_pred <- p6_poly_optimal %>% predict(stest_df_p6)
p6_poly_out <- mse(p6_poly_pred, stest_df_p6$shares)
p6_poly_out
#compile into final result
p6_poly_result <- data.frame(model = "Polynomial_deg_7", var = "kw_avg_avg", mse_out = p6_poly_out, mse_in = p6_poly_in)
p6_poly_result
p6_result <- rbind(p6_result, p6_poly_result)
p6_result
#non-binary variables
p6_spline_m <- gam(shares ~ s(strain_df_p6[,1]),data=strain_df_p6,family = gaussian())
View(p6_spline_m)
#in sample
#non-binary variables
index_nb_gam <- c(1:4, 6:12, 19:30, 39:59)
nonbinary_s <- c()
for (i in index_nb_gam){
p6_nb_spline_m <- gam(shares ~ s(strain_df_p6[,i]),data=strain_df_p6,family = gaussian())
nonbinary_s<-c(nonbinary_s, p6_nb_spline_m$gcv.ubre.dev)
}
#binary variables
index_b_gam <- c(5, 13:18, 31:38)
binary_s <- c()
for (i in index_b_gam){
p6_b_spline_m <- gam(shares ~ strain_df_p6[,i],data=strain_df_p6,family = gaussian())
binary_s<-c(binary_s, p6_b_spline_m$gcv.ubre.dev)
}
min(nonbinary)
min(nonbinary_s)
min(binary_s)
min(nonbinary_s)
min(binary_s) #
index_nb_gam[which.min(nonbinary_s)]
index_b_gam[which.min(binary_s)] #27th variable is kw_avg_avg
p6_nb_spline_m <- gam(shares ~ s(strain_df_p6[,27]),data=strain_df_p6,family = gaussian())
p6_b_spline_m <- gam(shares ~ strain_df_p6[,18],data=strain_df_p6,family = gaussian())
#since non-binary performs better based on in sample EPE, we use kw_avg_avg for spline
p6_spline_optimal <- gam(shares ~ s(strain_df_p6[,27]),data=strain_df_p6,family = gaussian())
p6_spline_in <- mse(strain_df_p6$shares, p6_spline_optimal$fitted.values)
p6_spline_in
p6_spline_in <- p6_spline_optimal$gcv.ubre.dev
p6_spline_in
p6_spline_out<-mse(stest_df_p6$shares,predict.gam(p6_spline_optimal,stest_df_p6))
strain_df_p6 <- as.data.frame(strain_df_p6)
stest_df_p6 <- as.data.frame(stest_df_p6)
index_nb_gam <- c(1:4, 6:12, 19:30, 39:59)
nonbinary_s <- c()
for (i in index_nb_gam){
p6_nb_spline_m <- gam(shares ~ s(strain_df_p6[,i]),data=strain_df_p6,family = gaussian())
nonbinary_s<-c(nonbinary_s, p6_nb_spline_m$gcv.ubre.dev)
}
min(nonbinary_s) #0.805739
index_nb_gam[which.min(nonbinary_s)]
#out of sample
p6_spline_out<-mse(stest_df_p6$shares,predict.gam(p6_spline_optimal,stest_df_p6))
#since non-binary performs better based on in sample EPE, we use kw_avg_avg for spline
p6_spline_optimal <- gam(shares ~ s(as.data.frame(strain_df_p6[,27])),data=strain_df_p6,family = gaussian())
#since non-binary performs better based on in sample EPE, we use kw_avg_avg for spline
p6_spline_optimal <- gam(shares ~ s(strain_df_p6$kw_avg_avg),data=strain_df_p6,family = gaussian())
p6_spline_in <- p6_spline_optimal$gcv.ubre.dev
p6_spline_in
#since non-binary performs better based on in sample EPE, we use kw_avg_avg for spline
p6_spline_optimal <- gam(shares ~ s(kw_avg_avg),data=strain_df_p6,family = gaussian())
p6_spline_in <- p6_spline_optimal$gcv.ubre.dev
p6_spline_in
#out of sample
p6_spline_out<-mse(shares,predict.gam(p6_spline_optimal,stest_df_p6), newdata = stest_df_p6)
#out of sample
p6_spline_out<-mse(stest_df_p6$shares,predict.gam(p6_spline_optimal,stest_df_p6))
p6_spline_out
strain_df_p6 <- as.data.frame(strain_df_p6)
stest_df_p6 <- as.data.frame(stest_df_p6)
#in sample
#non-binary variables
index_nb_gam <- c(1:4, 6:12, 19:30, 39:59)
nonbinary_s <- c()
for (i in index_nb_gam){
p6_nb_spline_m <- gam(shares ~ s(strain_df_p6[,i]),data=strain_df_p6,family = gaussian())
nonbinary_s<-c(nonbinary_s, p6_nb_spline_m$gcv.ubre.dev)
}
min(nonbinary_s) #0.805739
index_nb_gam[which.min(nonbinary_s)] #27th variable is kw_avg_avg (seems to be better candidate)
#binary variables
index_b_gam <- c(5, 13:18, 31:38)
binary_s <- c()
for (i in index_b_gam){
p6_b_spline_m <- gam(shares ~ strain_df_p6[,i],data=strain_df_p6,family = gaussian())
binary_s<-c(binary_s, p6_b_spline_m$gcv.ubre.dev)
}
min(binary_s) #0.8459762
#since non-binary performs better based on in sample EPE, we use kw_avg_avg for spline
p6_spline_optimal <- gam(shares ~ s(kw_avg_avg),data=strain_df_p6,family = gaussian())
p6_spline_in <- p6_spline_optimal$gcv.ubre.dev
p6_spline_in
#out of sample
p6_spline_out<-mse(stest_df_p6$shares,predict.gam(p6_spline_optimal,stest_df_p6))
p6_spline_out
#compile into final result
p6_spline_result <- data.frame(model = "Spline", var = "kw_avg_avg", mse_out = p6_spline_out, mse_in = p6_spline_in)
p6_result <- rbind(p6_result, p6_spline_result)
p6_result
low1 <- loess(shares ~ strain_df_p6[,1], data = strain_df_p6, span = .05)
View(low1)
predict(low1)
p6_LOESS <- c()
p6_LOESS_index <- c()
for (i in 1:59){
low1 <- loess(shares ~ strain_df_p6[,1], data = strain_df_p6, span = .05)
low2 <- loess(shares ~ strain_df_p6[,i], data = strain_df_p6, span = .5)
low3 <- loess(shares ~ strain_df_p6[,i], data = strain_df_p6, span = .75)
low4 <- loess(shares ~ strain_df_p6[,i], data = strain_df_p6, span = .95)
low_df <- data.frame(mse(strain_df_p6$shares, predict(low1)), mse(strain_df_p6$shares, predict(low2)), mse(strain_df_p6$shares, predict(low3)), mse(strain_df_p6$shares, predict(low4)))
p6_LOESS <- c(p6_LOESS, min(low_df))
p6_LOESS_index <- c(p6_LOESS_index, which.min(low_df))
}
